---
title: "Security"
linkTitle: "Security"
description: "Security Documentation for Kyverno"
type: docs
---

## How to contact the Security team?

All Kyverno communication happens on Slack or in the Community as well as Contributors Meeting so be a part of them by joining the [Slack workspace](https://slack.k8s.io/#kyverno) and [Kyverno google group](https://groups.google.com/g/kyverno). One can know more about our community [here](../community/).

## Disclosure process

If one finds a vulnerability in Kyverno please send an email to the security group at kyverno-security@googlegroups.com with the following information:
- description of the problem
- precise and detailed steps (include screenshots) that created the problem
- the affected version(s)
- any possible mitigations, if known

Kyverno Security group will send an initial response to the disclosure in 3-5 days. Once the vulnerability and fix are confirmed, the team will plan to release the fix in 7 to 28 days based on the severity and complexity.
One can take a deeper look at it [here](https://github.com/kyverno/kyverno/blob/main/SECURITY.md).

## Threat Model

The Kubernetes SIG Security team has defined an Admission Control Threat Model which one can take a look [here](https://docs.google.com/document/d/1tQTZ6wrD2udbUGL7xhc3SRxqyTvS8FQUlL59KHYHcY8/edit#heading=h.bx94h7ux7k41).


## Artifacts we upload for each release

With every release, Kyverno uploads the following artifacts:
- checksums.txt
- kyverno-cli_v<version_number>_darwin_x86_64.tar.gz
- kyverno-cli_v<version_number>_linux_x86_64.tar.gz
- kyverno-cli_v<version_number>_windows_x86_64.zip
- Source code (zip)
- Source code (tar.gz)

An SBOM is also uploaded on each version release that can be found on the `release` Github action for that tag or can be downloaded using Cosign.

## Verifying Kyverno Images

Kyverno container images are signed using Cosign. To verify the container image, download the organization public key (https://github.com/kyverno/kyverno/blob/main/cosign.pub) into a file named cosign.pub and then:

1. Install Cosign
2. Configure the Kyverno signature repository:

```sh
export COSIGN_REPOSITORY=ghcr.io/kyverno/signatures
```

3. Verify the image:

```sh
cosign verify -key cosign.pub ghcr.io/kyverno/kyverno:latest
```

If the container image was properly signed, the output should be similar to:

```sh
Verification for kyverno/kyverno:latest --
The following checks were performed on each of these signatures:
  - The cosign claims were validated
  - The signatures were verified against the specified public key
  - Any certificates were verified against the Fulcio roots.
[{"critical":{"identity":{"docker-reference":"ghcr.io/kyverno/kyverno"},"image":{"docker-manifest-digest":"sha256:a847df12e2c1cab19af9d1bb34e599cb56cf57639c7d5c958a4bb568c1dad8f6"},"type":"cosign container image signature"},"optional":null}]
```

All 3 of Kyverno images can be verified: `kyvernopre`, `kyverno`, and `kyverno-cli`.

## Fetching the SBOM for Kyverno

An SBOM (Software Bill of Materials) in CycloneDX JSON format is published for each Kyverno release. To download the SBOM for a specific version, install cosign and run:

```sh
cosign download sbom ghcr.io/kyverno/sbom:latest
```

To save the SBOM to a file, run the following command:

```sh
cosign download sbom ghcr.io/kyverno/sbom:latest > kyverno.sbom.json
```

## Scorecard index

Kyverno uses [Scorecards by OSSF](https://github.com/ossf/scorecard) to maintain repository-wide security standards. The current OSSF/scorecard score for Kyverno can be found in this [tracker issue](https://github.com/kyverno/kyverno/issues/2617). Kyverno believes in improving this score as much as possible keeping in mind the practices that are followed. Contributions to improve this score are welcomed.

## ArtifactHub

Kyverno is available via the [ArtifactHub page](https://artifacthub.io/packages/helm/kyverno/kyverno) also. One can also look at the auto-generated [Security Report](https://artifacthub.io/packages/helm/kyverno/kyverno?modal=security-report) generated by ArtifactHub for all the releases.

## RBAC Configuration for Kyverno

Kyverno installs with the roles defined [here](https://github.com/kyverno/kyverno/blob/main/definitions/k8s-resource/clusterroles.yaml)
These roles have been taken from [our self-assessment document](https://github.com/kyverno/tag-security/blob/main/assessments/projects/kyverno/self-assessment.md#kyverno-roles).

- kyverno:admin-policies

```
$ kubectl describe clusterrole kyverno:admin-policies

Name:         kyverno:admin-policies
Labels:       rbac.authorization.k8s.io/aggregate-to-admin=true
Annotations:  <none>
PolicyRule:
  Resources                   Non-Resource URLs  Resource Names  Verbs
  ---------                   -----------------  --------------  -----
  clusterpolicies.kyverno.io  []                 []              [*]
  policies.kyverno.io         []                 []              [*]
```

- kyverno:admin-policyreport

```
$ kubectl describe clusterrole kyverno:admin-policyreport

Name:         kyverno:admin-policyreport
Labels:       rbac.authorization.k8s.io/aggregate-to-admin=true
Annotations:  <none>
PolicyRule:
  Resources                                     Non-Resource URLs  Resource Names  Verbs
  ---------                                     -----------------  --------------  -----
  clusterpolicyreports.wgpolicyk8s.io/v1alpha1  []                 []              [*]
  policyreports.wgpolicyk8s.io/v1alpha1         []                 []              [*]
```

- kyverno:admin-reportchangerequest

```
$ kubectl describe clusterrole kyverno:admin-reportchangerequest

Name:         kyverno:admin-reportchangerequest
Labels:       rbac.authorization.k8s.io/aggregate-to-admin=true
Annotations:  <none>
PolicyRule:
  Resources                               Non-Resource URLs  Resource Names  Verbs
  ---------                               -----------------  --------------  -----
  clusterreportchangerequests.kyverno.io  []                 []              [*]
  reportchangerequests.kyverno.io         []                 []              [*]
```

- kyverno:customresources

```
$ kubectl describe clusterrole kyverno:customresources

Name:         kyverno:customresources
Labels:       <none>
Annotations:  <none>
PolicyRule:
  Resources                                       Non-Resource URLs  Resource Names  Verbs
  ---------                                       -----------------  --------------  -----
  clusterpolicies.*/status                        []                 []              [create delete get list patch update watch]
  clusterpolicies.*                               []                 []              [create delete get list patch update watch]
  clusterpolicyreports.*/status                   []                 []              [create delete get list patch update watch]
  clusterpolicyreports.*                          []                 []              [create delete get list patch update watch]
  clusterreportchangerequests.*/status            []                 []              [create delete get list patch update watch]
  clusterreportchangerequests.*                   []                 []              [create delete get list patch update watch]
  generaterequests.*/status                       []                 []              [create delete get list patch update watch]
  generaterequests.*                              []                 []              [create delete get list patch update watch]
  policies.*/status                               []                 []              [create delete get list patch update watch]
  policies.*                                      []                 []              [create delete get list patch update watch]
  policyreports.*/status                          []                 []              [create delete get list patch update watch]
  policyreports.*                                 []                 []              [create delete get list patch update watch]
  reportchangerequests.*/status                   []                 []              [create delete get list patch update watch]
  reportchangerequests.*                          []                 []              [create delete get list patch update watch]
  customresourcedefinitions.apiextensions.k8s.io  []                 []              [delete]
```

- kyverno:generatecontroller

```
$ kubectl describe clusterrole kyverno:generatecontroller

Name:         kyverno:generatecontroller
Labels:       <none>
Annotations:  <none>
PolicyRule:
  Resources          Non-Resource URLs  Resource Names  Verbs
  ---------          -----------------  --------------  -----
  namespaces.*       []                 []              [create update delete list get watch]
  configmaps.*       []                 []              [create update delete list get]
  limitranges.*      []                 []              [create update delete list get]
  networkpolicies.*  []                 []              [create update delete list get]
  resourcequotas.*   []                 []              [create update delete list get]
  secrets.*          []                 []              [create update delete list get]
```

- kyverno:policycontroller

```
$ kubectl describe clusterrole kyverno:policycontroller

Name:         kyverno:policycontroller
Labels:       <none>
Annotations:  <none>
PolicyRule:
  Resources  Non-Resource URLs  Resource Names  Verbs
  ---------  -----------------  --------------  -----
  *.*        []                 []              [get list update watch]
```

- kyverno:userinfo

```
$ kubectl describe clusterrole kyverno:userinfo

Name:         kyverno:userinfo
Labels:       <none>
Annotations:  <none>
PolicyRule:
  Resources              Non-Resource URLs  Resource Names  Verbs
  ---------              -----------------  --------------  -----
  clusterrolebindings.*  []                 []              [watch list]
  clusterroles.*         []                 []              [watch list]
  configmaps.*           []                 []              [watch list]
  namespaces.*           []                 []              [watch list]
  rolebindings.*         []                 []              [watch list]
  roles.*                []                 []              [watch list]
```

- kyverno:webhook

```
$ kubectl describe clusterrole kyverno:webhook

Name:         kyverno:webhook
Labels:       <none>
Annotations:  <none>
PolicyRule:
  Resources                                                Non-Resource URLs  Resource Names                  Verbs
  ---------                                                -----------------  --------------                  -----
  signers.certificates.k8s.io                              []                 [kubernetes.io/legacy-unknown]  [approve]
  certificatesigningrequests.*/approval                    []                 []                              [create delete get list patch update watch]
  certificatesigningrequests.*                             []                 []                              [create delete get list patch update watch]
  events.*                                                 []                 []                              [create delete get list patch update watch]
  mutatingwebhookconfigurations.*                          []                 []                              [create delete get list patch update watch]
  validatingwebhookconfigurations.*                        []                 []                              [create delete get list patch update watch]
  certificatesigningrequests.certificates.k8s.io/approval  []                 [kubernetes.io/legacy-unknown]  [create delete get update watch]
  certificatesigningrequests.certificates.k8s.io/status    []                 [kubernetes.io/legacy-unknown]  [create delete get update watch]
  certificatesigningrequests.certificates.k8s.io           []                 [kubernetes.io/legacy-unknown]  [create delete get update watch]
```
